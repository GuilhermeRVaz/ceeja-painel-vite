create table public.enrollments (
  id uuid not null default gen_random_uuid (),
  user_id uuid not null,
  status text not null default 'iniciada'::text,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  extracted_personal_data jsonb null,
  extracted_address_data jsonb null,
  confirmed_personal_data jsonb null,
  confirmed_address_data jsonb null,
  confirmed_schooling_data jsonb null,
  extracted_schooling_data jsonb null,
  student_id uuid null,
  constraint enrollments_pkey primary key (id),
  constraint enrollments_student_id_fkey foreign KEY (student_id) references students (id) on delete set null,
  constraint enrollments_user_id_fkey foreign KEY (user_id) references profiles (user_id) on delete CASCADE
) TABLESPACE pg_default;

create table public.students (
  id uuid not null default gen_random_uuid (),
  created_at timestamp with time zone null default now(),
  enrollment_id uuid null,
  constraint students_pkey primary key (id),
  constraint students_enrollment_id_key unique (enrollment_id)
) TABLESPACE pg_default;


create table public.personal_data (
  id uuid not null default extensions.uuid_generate_v4 (),
  nome_completo text null,
  tem_nome_social boolean null default false,
  nome_social text null,
  tem_nome_afetivo boolean null default false,
  nome_afetivo text null,
  sexo text null,
  rg text null,
  rg_digito text null,
  rg_uf text null,
  rg_data_emissao date null,
  cpf text null,
  raca_cor text null,
  data_nascimento date null,
  nome_mae text null,
  nome_pai text null,
  nacionalidade text null,
  nascimento_uf text null,
  nascimento_cidade text null,
  pais_origem text null,
  possui_internet boolean null,
  possui_device boolean null,
  telefone text null,
  email text null,
  is_gemeo boolean null,
  nome_gemeo text null,
  trabalha boolean null,
  profissao text null,
  empresa text null,
  is_pcd boolean null,
  deficiencia text null,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  idade integer null,
  student_id uuid null,
  constraint personal_data_pkey primary key (id),
  constraint personal_data_cpf_key unique (cpf),
  constraint personal_data_email_key unique (email),
  constraint personal_data_student_id_key unique (student_id),
  constraint personal_data_student_id_fkey foreign KEY (student_id) references students (id) on delete CASCADE
) TABLESPACE pg_default;

create index IF not exists idx_personal_data_cpf on public.personal_data using btree (cpf) TABLESPACE pg_default;

create index IF not exists idx_personal_data_email on public.personal_data using btree (email) TABLESPACE pg_default;


create table public.addresses (
  id uuid not null default extensions.uuid_generate_v4 (),
  cep text null,
  logradouro text null,
  numero text null,
  complemento text null,
  bairro text null,
  "nomeCidade" text null,
  "ufCidade" text null,
  zona text null,
  "temLocalizacaoDiferenciada" boolean null default false,
  "localizacaoDiferenciada" text null,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  student_id uuid null,
  constraint addresses_pkey primary key (id),
  constraint addresses_student_id_key unique (student_id),
  constraint addresses_student_id_fkey foreign KEY (student_id) references students (id) on delete CASCADE
) TABLESPACE pg_default;


create table public.schooling_data (
  id uuid not null default extensions.uuid_generate_v4 (),
  nivel_ensino text null default 'Ensino MÃ©dio'::text,
  itinerario_formativo text null,
  ultima_serie_concluida text null,
  estudou_no_ceeja boolean null,
  tem_progressao_parcial boolean null,
  progressao_parcial_disciplinas jsonb null,
  eliminou_disciplina boolean null,
  eliminou_disciplina_nivel text null,
  eliminou_disciplinas text[] null,
  optou_ensino_religioso boolean null,
  optou_educacao_fisica boolean null,
  aceitou_termos boolean null,
  data_aceite timestamp with time zone null,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  ra text null,
  tipo_escola text null,
  nome_escola text null,
  student_id uuid null,
  constraint schooling_data_pkey primary key (id),
  constraint schooling_data_student_id_key unique (student_id),
  constraint schooling_data_student_id_fkey foreign KEY (student_id) references students (id) on delete CASCADE
) TABLESPACE pg_default;

create index IF not exists idx_schooling_data_ra on public.schooling_data using btree (ra) TABLESPACE pg_default;